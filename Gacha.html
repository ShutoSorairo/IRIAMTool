<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ã‚«ã‚¹ã‚¿ãƒ ã‚¬ãƒãƒ£</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="index.css">
    <style>
        body { background: #f0f2f5; font-family: 'M PLUS Rounded 1c', sans-serif; }
        .gacha-container { max-width: 900px; margin: 0 auto; padding: 20px; text-align: center; }

        /* ã‚¬ãƒãƒ£æ©Ÿã‚¨ãƒªã‚¢ */
        .machine-area {
            background: #fff;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        /* è¨­å®šã‚¨ãƒªã‚¢ (é–‹é–‰å¼) */
        .settings-box {
            background: #e3f2fd;
            border: 2px dashed #90caf9;
            border-radius: 12px;
            padding: 20px;
            margin-top: 40px;
            text-align: left;
        }
        .settings-title { font-weight: bold; margin-bottom: 10px; color: #1565c0; display:flex; justify-content:space-between; cursor:pointer;}
        
        /* å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ  */
        .input-row { display: flex; gap: 10px; margin-bottom: 10px; flex-wrap: wrap; }
        .input-row input { padding: 8px; border-radius: 4px; border: 1px solid #ccc; flex: 1; }
        .btn-add { background: #4caf50; color: white; border: none; padding: 8px 20px; border-radius: 4px; cursor: pointer; }
        
        /* ç™»éŒ²æ¸ˆã¿ãƒªã‚¹ãƒˆ */
        .item-list { max-height: 200px; overflow-y: auto; background: #fff; border: 1px solid #ddd; padding: 10px; border-radius: 4px; }
        .item-row { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee; padding: 5px 0; }
        .item-preview { width: 30px; height: 30px; object-fit: contain; vertical-align: middle; margin-right: 10px; }
        .btn-del { background: #f44336; color: white; border: none; padding: 2px 8px; border-radius: 4px; cursor: pointer; font-size: 0.8em; }

        /* ãƒœã‚¿ãƒ³ç¾¤ */
        .controls { display: flex; justify-content: center; gap: 20px; margin-top: 20px; }
        .btn-gacha {
            border: none; padding: 15px 40px; font-size: 1.2rem; font-weight: bold; color: #fff;
            border-radius: 50px; cursor: pointer; box-shadow: 0 5px 0 rgba(0,0,0,0.2); transition: transform 0.1s;
        }
        .btn-gacha:active { transform: translateY(3px); box-shadow: none; }
        .btn-1 { background: linear-gradient(135deg, #4facfe, #00f2fe); }
        .btn-10 { background: linear-gradient(135deg, #ff9a9e, #fecfef); color: #d63384; }

        /* ã‚«ãƒ¼ãƒ‰çµæœ */
        .result-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 15px; margin-top: 30px; }
        .card { background: #fff; border-radius: 12px; padding: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); animation: popIn 0.3s backwards; border: 3px solid #ddd; }
        .card-img { width: 100%; height: 100px; object-fit: contain; margin-bottom: 5px; }
        
        /* ãƒ¬ã‚¢ãƒªãƒ†ã‚£è‰² */
        .rarity-UR { border-color: #ff00ff; background: #fff0ff; }
        .rarity-SSR { border-color: #ffd700; background: #fffff0; }
        .rarity-SR { border-color: #c0c0c0; }
        
        @keyframes popIn { from { transform: scale(0); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    </style>
</head>
<body>
    <div class="gacha-container">
        <a href="index.html" style="color:#888; text-decoration:none;">â† ãƒ›ãƒ¼ãƒ ã¸æˆ»ã‚‹</a>

        <div class="machine-area">
            <h1>ğŸ’ ã‚«ã‚¹ã‚¿ãƒ ã‚¬ãƒãƒ£</h1>
            <p>ä¸‹ã®è¨­å®šã‚¨ãƒªã‚¢ã§å¥½ããªã‚¢ã‚¤ãƒ†ãƒ ã‚’è¿½åŠ ã—ã¦ã­ï¼</p>
            
            <div class="controls">
                <button class="btn-gacha btn-1" onclick="playGacha(1)">1å›</button>
                <button class="btn-gacha btn-10" onclick="playGacha(10)">10é€£</button>
            </div>
            
            <div id="result-area" class="result-grid"></div>
        </div>

        <div class="settings-box">
            <div class="settings-title" onclick="toggleSettings()">
                <span>ğŸ› ï¸ ã‚¬ãƒãƒ£ã®ä¸­èº«ã‚’è¨­å®š (ã‚¯ãƒªãƒƒã‚¯ã§é–‹é–‰)</span>
                <span>â–¼</span>
            </div>
            <div id="settings-content">
                <p style="font-size:0.9em; color:#666; margin-bottom:10px;">
                    ç”»åƒãƒ‘ã‚¹ã€åå‰ã€ãƒã‚¤ãƒ³ãƒˆã‚’å…¥åŠ›ã—ã¦è¿½åŠ ã—ã¦ãã ã•ã„ã€‚<br>
                    ãƒ‡ãƒ¼ã‚¿ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚
                </p>
                
                <div class="input-row">
                    <input type="text" id="in-name" placeholder="åå‰ (ä¾‹: å¤§å½“ãŸã‚Š)">
                    <input type="number" id="in-pt" placeholder="PT (ä¾‹: 10000)">
                    <input type="text" id="in-src" placeholder="ç”»åƒãƒ‘ã‚¹/URL">
                </div>
                <div style="text-align:right; margin-bottom:10px;">
                    <button class="btn-add" onclick="addItem()">è¿½åŠ ã™ã‚‹</button>
                </div>

                <div class="item-list" id="custom-list">
                    </div>
                
                <div style="text-align:right; margin-top:10px;">
                    <button onclick="resetData()" style="background:#666; color:white; border:none; padding:5px 10px; border-radius:4px; cursor:pointer;">å…¨å‰Šé™¤</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ã‚¬ãƒãƒ£ãƒ‡ãƒ¼ã‚¿ (ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰èª­ã¿è¾¼ã‚€)
        let gachaItems = [];
        const STORAGE_KEY = 'iriam_custom_gacha_v1';

        // åˆæœŸåŒ–
        window.onload = function() {
            loadItems();
        };

        // ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
        function loadItems() {
            const stored = localStorage.getItem(STORAGE_KEY);
            if (stored) {
                gachaItems = JSON.parse(stored);
            } else {
                // åˆå›ã ã‘ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’å…¥ã‚Œã‚‹
                gachaItems = [
                    { name: "ã‚µãƒ³ãƒ—ãƒ«100pt", pt: 100, src: "https://placehold.jp/150x150.png?text=100pt" },
                    { name: "ã‚µãƒ³ãƒ—ãƒ«UR", pt: 10000, src: "https://placehold.jp/150x150.png?text=UR" }
                ];
            }
            renderList();
        }

        // ãƒªã‚¹ãƒˆæç”» (è¨­å®šã‚¨ãƒªã‚¢)
        function renderList() {
            const listEl = document.getElementById('custom-list');
            listEl.innerHTML = '';
            
            if (gachaItems.length === 0) {
                listEl.innerHTML = '<div style="color:#999; text-align:center;">ã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚Šã¾ã›ã‚“</div>';
                return;
            }

            gachaItems.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'item-row';
                div.innerHTML = `
                    <div style="display:flex; align-items:center;">
                        <img src="${item.src}" class="item-preview" onerror="this.src=''">
                        <span style="font-weight:bold; margin-right:10px;">${item.name}</span>
                        <span style="color:#666; font-size:0.9em;">(${item.pt}pt)</span>
                    </div>
                    <button class="btn-del" onclick="deleteItem(${index})">å‰Šé™¤</button>
                `;
                listEl.appendChild(div);
            });
        }

        // ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ 
        function addItem() {
            const name = document.getElementById('in-name').value;
            const pt = parseInt(document.getElementById('in-pt').value);
            const src = document.getElementById('in-src').value;

            if (!name || isNaN(pt) || !src) {
                alert("ã™ã¹ã¦ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
                return;
            }

            gachaItems.push({ name, pt, src });
            saveItems();
            
            // å…¥åŠ›ã‚¯ãƒªã‚¢
            document.getElementById('in-name').value = '';
            document.getElementById('in-pt').value = '';
            document.getElementById('in-src').value = '';
        }

        // ã‚¢ã‚¤ãƒ†ãƒ å‰Šé™¤
        function deleteItem(index) {
            gachaItems.splice(index, 1);
            saveItems();
        }

        // ãƒ‡ãƒ¼ã‚¿ä¿å­˜
        function saveItems() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(gachaItems));
            renderList();
        }
        
        // å…¨å‰Šé™¤
        function resetData() {
            if(confirm("æœ¬å½“ã«å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")) {
                gachaItems = [];
                saveItems();
            }
        }

        // ã‚¬ãƒãƒ£ã‚’å›ã™
        function playGacha(times) {
            if (gachaItems.length === 0) {
                alert("è¨­å®šã‚¨ãƒªã‚¢ã‹ã‚‰ã‚¢ã‚¤ãƒ†ãƒ ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ï¼");
                return;
            }

            const resultArea = document.getElementById('result-area');
            resultArea.innerHTML = '';

            for (let i = 0; i < times; i++) {
                // ãƒ©ãƒ³ãƒ€ãƒ æŠ½é¸
                const item = gachaItems[Math.floor(Math.random() * gachaItems.length)];
                
                // ãƒ¬ã‚¢ãƒªãƒ†ã‚£åˆ¤å®š
                let rarityClass = "";
                let rarityLabel = "N";
                if (item.pt >= 10000) { rarityClass = "rarity-UR"; rarityLabel = "UR"; }
                else if (item.pt >= 3000) { rarityClass = "rarity-SSR"; rarityLabel = "SSR"; }
                else if (item.pt >= 500) { rarityClass = "rarity-SR"; rarityLabel = "SR"; }

                const card = document.createElement('div');
                card.className = `card ${rarityClass}`;
                card.style.animationDelay = (i * 0.1) + "s";
                card.innerHTML = `
                    <div style="font-size:0.8em; font-weight:bold; color:#888;">${rarityLabel}</div>
                    <img src="${item.src}" class="card-img">
                    <div style="font-weight:bold; font-size:0.9em;">${item.name}</div>
                    <div style="font-size:0.8em; color:#666;">${item.pt}pt</div>
                `;
                resultArea.appendChild(card);
            }
        }

        function toggleSettings() {
            const content = document.getElementById('settings-content');
            content.style.display = content.style.display === 'none' ? 'block' : 'none';
        }
    </script>
</body>
</html>
